<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>TV Player</title>
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            height: 100%;
            background: black;
            overflow: hidden;
        }

        video {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .fire {
            z-index: 1;
            position: absolute;
            top: 0%;
            left: 0%;
            height: 100%;
            object-fit: contain;
            width: 100%;
            display: none;
        }
    </style>
</head>

<body>

    <video id="video" src="TrainRide.mp4" playsinline></video>

    <img id="fire" class="fire" src="fire.webp" />

    <script>
        const video = document.getElementById("video");
        const socket = new WebSocket("ws://" + location.host);

        // default playback rate
        let targetRate = 1.0;

        socket.onmessage = (event) => {
            const msg = JSON.parse(event.data);

            if (msg.type === 'pause') video.pause();
            else if (msg.type === 'throttle') {
                // throttle 0–1 maps to playbackRate 0.5–2
                targetRate = 0.1 + msg.value * 1.9;
                video.playbackRate = targetRate;
                video.play();
                if (video.paused && msg.value > 0) video.play();
            }
            else if (msg.type === 'restart') {
                video.currentTime = 0;
            }
        };
    </script>

</body>

</html>